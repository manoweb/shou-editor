<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test - JSImageEditor</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; font-family: system-ui, sans-serif; background: #121212; color: #e0e0e0; }
    body { display: flex; flex-direction: column; }

    .demo-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 20px; background: #1a1a2e; border-bottom: 1px solid #333;
    }
    .demo-header h1 { font-size: 16px; font-weight: 600; }
    .demo-header .actions { display: flex; gap: 8px; }
    .demo-header button {
      padding: 6px 14px; border: none; border-radius: 4px;
      font-size: 13px; cursor: pointer; color: #fff;
    }
    .btn-embed { background: #007acc; }
    .btn-modal { background: #16813d; }
    .btn-preset { background: #9b59b6; }
    .btn-embed:hover { background: #005f9e; }
    .btn-modal:hover { background: #12692f; }
    .btn-preset:hover { background: #7d3c98; }

    #editor-container { flex: 1; overflow: hidden; }

    #result {
      display: none; position: fixed; inset: 0; z-index: 9999;
      background: rgba(0,0,0,0.85); align-items: center; justify-content: center;
      flex-direction: column; gap: 12px;
    }
    #result img { max-width: 80vw; max-height: 70vh; border-radius: 6px; box-shadow: 0 4px 20px rgba(0,0,0,0.5); }
    #result button {
      padding: 8px 20px; background: #333; color: #fff;
      border: none; border-radius: 4px; cursor: pointer; font-size: 13px;
    }
    #result button:hover { background: #444; }
  </style>
</head>
<body>

  <div class="demo-header">
    <h1>JSImageEditor - Demo</h1>
    <div class="actions">
      <button class="btn-embed" onclick="initEmbed()">Embebido</button>
      <button class="btn-preset" onclick="initPreset()">Preset (lienzo vacío)</button>
      <button class="btn-modal" onclick="openModal()">Abrir Modal</button>
    </div>
  </div>

  <div id="editor-container"></div>

  <div id="result">
    <img id="result-img" src="" alt="Resultado">
    <button onclick="closeResult()">Cerrar</button>
  </div>

  <script src="js/image-editor.js"></script>
  <script>
    let currentEditor = null;

    function showResult(base64) {
      document.getElementById('result-img').src = base64;
      document.getElementById('result').style.display = 'flex';
    }

    function closeResult() {
      document.getElementById('result').style.display = 'none';
    }

    // Modo embebido: ocupa el contenedor
    function initEmbed() {
      if (currentEditor) currentEditor.destroy();
      const container = document.getElementById('editor-container');
      container.innerHTML = '';

      currentEditor = JSImageEditor.init(container, {
        theme: 'dark',
        lang: 'es',
        width: '100%',
        height: '100%',
        onSave: (base64) => showResult(base64),
        onCancel: () => {
          currentEditor.destroy();
          currentEditor = null;
          container.innerHTML = '';
        }
      });
    }

    // Modo preset: lienzo vacío con capas predefinidas
    function initPreset() {
      if (currentEditor) currentEditor.destroy();
      const container = document.getElementById('editor-container');
      container.innerHTML = '';

      currentEditor = JSImageEditor.init(container, {
        theme: 'dark',
        lang: 'es',
        width: '100%',
        height: '100%',
        preset: {
          width: 800,
          height: 600,
          layers: [
            { name: 'Fondo', fill: '#fce4ec', opacity: 1 },
            { name: 'Contenido', opacity: 1 },
            { name: 'Texto', opacity: 0.9 },
          ]
        },
        onSave: (base64) => showResult(base64),
        onCancel: () => {
          currentEditor.destroy();
          currentEditor = null;
          container.innerHTML = '';
        }
      });
    }

    // Modo modal: se abre sobre todo
    function openModal() {
      JSImageEditor.open(null, {
        theme: 'dark',
        lang: 'es',
        onSave: (base64) => showResult(base64),
        onCancel: () => {}
      });
    }

    // Iniciar en modo embebido por defecto
    initEmbed();
  </script>
</body>
</html>
